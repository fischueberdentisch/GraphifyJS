class Graph{constructor(t,s,i,h,e,a){this.canvas=t,this.ctx=this.canvas.getContext("2d"),this.ctx.font="16px Arial",this.datasets=s||[],this.colors=i||["#0000ff","#ff0000","#00ff00","#ffff00","#ff00ff","#00ffff"],this.steps=a,this.stepSize=this.canvas.width/this.steps,this.updateTimer=e,this.smooth=h}getRandomNumber(t,s){return Math.random()*(s-t)+t}drawCurve(t,s){var i=this.canvas.height/this.findMaxValue();if(!0==this.smooth){this.ctx.beginPath(),this.ctx.lineWidth=4,this.ctx.strokeStyle=s,this.ctx.fillStyle=s+"30",this.ctx.moveTo(0,this.canvas.height),this.ctx.lineTo(0,this.canvas.height-t[0]*i);for(var h=1;h<t.length;h++){var e=(h-.5)*this.stepSize,a=(this.canvas.height-t[h-1]*i+this.canvas.height-t[h]*i)/2;this.ctx.quadraticCurveTo((h-1)*this.stepSize,this.canvas.height-t[h-1]*i,e,a)}this.ctx.lineTo((t.length-1)*this.stepSize,this.canvas.height-t[t.length-1]*i),this.ctx.lineTo((t.length-1)*this.stepSize,this.canvas.height),this.ctx.stroke(),this.ctx.closePath(),this.ctx.fill()}else{this.ctx.beginPath(),this.ctx.lineWidth=4,this.ctx.strokeStyle=s,this.ctx.fillStyle=s+"30",this.ctx.moveTo(0,this.canvas.height-t[0]*i);for(let c=1;c<t.length;c++){let l=c*this.stepSize,n=this.canvas.height-t[c]*i;this.ctx.lineTo(l,n)}this.ctx.lineTo((t.length-1)*this.stepSize,this.canvas.height),this.ctx.lineTo(0,this.canvas.height),this.ctx.stroke(),this.ctx.closePath(),this.ctx.fill()}}updateDatasets(t){for(var s=0;s<this.datasets.length;s++)if(this.datasets[s].length==Math.round(this.canvas.width/this.stepSize)+1){for(var i=0;i<this.datasets[s].length-1;i++)this.datasets[s][i]=this.datasets[s][i+1];this.datasets[s][this.datasets[s].length-1]=t[s]}else this.datasets[s].push(t[s])}mainLoop(){this.drawBackground();for(var t=0;t<this.datasets.length;t++)this.drawCurve(this.datasets[t],this.colors[t]);this.drawLabels()}drawBackground(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.ctx.fillStyle="#000000",this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),this.ctx.beginPath(),this.ctx.lineWidth=1,this.ctx.strokeStyle="#303030";for(var t=this.canvas.height;t>0;t-=this.canvas.height/this.findMaxValue())this.ctx.moveTo(0,t),this.ctx.lineTo(this.canvas.width,t);this.ctx.stroke()}drawLabels(){this.ctx.fillStyle="#ffffff",this.ctx.fillText("Value:",10,20);let t=10+this.ctx.measureText("Value:").width+5;for(let s=0;s<this.datasets.length;s++){let i=this.datasets[s],h=this.colors[s],e=i[i.length-1].toString(),a=this.ctx.measureText(e).width;this.ctx.fillStyle=h,this.ctx.fillText(e,t,20),this.ctx.fillRect(t+a+5,5,20,20),t+=a+30}let c=this.updateTimer/1e3*this.steps+" seconds ago";this.ctx.fillStyle="#ffffff",this.ctx.fillText(c,10,this.canvas.height-10),this.ctx.fillText("now",this.canvas.width-60,this.canvas.height-10),this.ctx.fillText("0",this.canvas.width-20,this.canvas.height-20),this.ctx.fillText(this.findMaxValue(),this.canvas.width-20,20)}getValue(){return Math.round(this.getRandomNumber(0,10))}findMaxValue(){for(var t=[],s=0;s<this.datasets.length;s++){var i=Math.max(...this.datasets[s]);isNaN(i)?t.push(0):t.push(i)}var h=Math.max(...t);return isNaN(h)?0:Math.round(h)}addDataset(t){for(var s=Math.round(this.canvas.width/this.stepSize),i=[],h=0;h<s;h++)i.push(0);this.datasets.push(i)}start(){setInterval(this.mainLoop.bind(this),this.updateTimer)}}
